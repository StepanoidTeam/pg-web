(this["webpackJsonppg-web"]=this["webpackJsonppg-web"]||[]).push([[0],{28:function(e,t,a){e.exports=a(46)},33:function(e,t,a){},40:function(e,t,a){},41:function(e){e.exports=JSON.parse('{"name":"pg-web","homepage":"https://stepanoidteam.github.io/pg-web","version":"0.1.1","private":true,"scripts":{"start":"react-scripts start","deploy":"gh-pages -d build -m deployment","predeploy":"npm version patch -f && npm run build","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"dependencies":{"@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.4.0","@testing-library/user-event":"^7.2.1","classnames":"^2.2.6","react":"^16.12.0","react-dom":"^16.12.0","react-router-dom":"^5.1.2","react-scripts":"3.3.0","source-map-explorer":"^2.2.2","use-global-hook":"^0.1.12"},"eslintConfig":{"extends":"react-app","rules":{"no-empty-pattern":"off","react-hooks/exhaustive-deps":"off"}},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"gh-pages":"^2.2.0"}}')},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(24),o=a.n(c),s=(a(33),a(1)),l=a(4),i=a(8),u=a(14),m=a.n(u),p=a(9),f=a.n(p),d="https://pg-api.azurewebsites.net/api";function h(e){var t,a,n,r,c,o=arguments;return f.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:for(s.prev=0,t=o.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=o[n];return s.next=4,f.a.awrap(fetch.apply(void 0,["".concat(d,"/").concat(e)].concat(a)));case 4:if((r=s.sent).ok){s.next=9;break}return s.next=8,f.a.awrap(r.json());case 8:throw s.sent;case 9:return s.next=11,f.a.awrap(r.json());case 11:return c=s.sent,s.abrupt("return",c.data);case 15:return s.prev=15,s.t0=s.catch(0),console.warn("api error",s.t0),s.abrupt("return",Promise.reject(s.t0));case 19:case"end":return s.stop()}}),null,null,[[0,15]])}var b=f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h("version").then((function(e){return e.version})));case 1:case"end":return e.stop()}})),v=a(15),g=a(27),E=a(10),j=a(11),O=function(){function e(){Object(E.a)(this,e)}return Object(j.a)(e,null,[{key:"set",value:function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new Date(Date.now()+n*e.msDay);document.cookie="".concat(t,"=").concat(a,";expires=").concat(r.toUTCString(),";path=/")}},{key:"get",value:function(e){var t=document.cookie.split("; ").map((function(e){return e.split("=")})).find((function(t){var a=Object(s.a)(t,2),n=a[0];a[1];return n===e}))||[,null];return Object(s.a)(t,2)[1]}},{key:"delete",value:function(e){var t=new Date(0);document.cookie="".concat(e,"=;expires=").concat(t.toUTCString(),";path=/")}},{key:"clear",value:function(){document.cookie.split("; ").map((function(e){return e.split("=")})).forEach((function(t){var a=Object(s.a)(t,1)[0];return e.delete(a)}))}}]),e}();O.msDay=864e5;var w={isOnline:!1,authToken:O.get("authToken"),isAuthenticated:!1,user:null,counter:0},x={setOnline:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.setState({isOnline:t})},addToCounter:function(e,t){e.setState({counter:e.state.counter+1})},setUserData:function(e,t){var a=t.AuthToken,n=t.Id,r=t.Name;e.setState({authToken:a,user:{id:n,name:r},isAuthenticated:!0}),O.set("authToken",a)},clearUserData:function(e){e.setState({authToken:null,user:null,isAuthenticated:!1}),O.delete("authToken")}},N=Object(g.a)(r.a,w,x);function y(e){var t=e.children,a=Object(v.a)(e,["children"]),n=N(),c=Object(s.a)(n,1)[0].isAuthenticated;return r.a.createElement(i.b,Object.assign({},a,{render:function(e){var a=e.location;return c?t:r.a.createElement(i.a,{to:{pathname:"/login",state:{from:a}}})}}))}var k=a(17),T=a(16),S=a(18),C=(a(40),a(41).version),D=function(e){function t(e){var a;return Object(E.a)(this,t),a=Object(k.a)(this,Object(T.a)(t).call(this,e)),b.then((function(e){console.log(e),a.setState({apiVersion:e})})).catch((function(e){console.log("err",e),a.setState({hasError:e})})).finally((function(){a.setState({isLoading:!1})})),a.state={isLoading:!0,hasError:null,apiVersion:null,webVersion:C},a}return Object(S.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.state,t=e.apiVersion,a=e.hasError,n=e.isLoading;return r.a.createElement("div",{className:"version-holder flex-column m-1"},r.a.createElement("span",null,"web: ",C),n&&r.a.createElement("span",null,"loading..."),!n&&t&&r.a.createElement("span",null,"api: ",t),a?r.a.createElement("span",null,"Has error: ",JSON.stringify(a)):null)}}]),t}(r.a.Component),A=a(12),U=(a(42),function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(k.a)(this,Object(T.a)(t).call(this,e))).state={isFocused:!1},a}return Object(S.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.label,n=t.value,c=t.helperText,o=t.icon,s=t.errorText,l=t.onChange,i=this.state.isFocused,u=0===n.length,p=!!s;return r.a.createElement("label",{className:m()("input cursor-pointer",{"is-focused":i,"is-empty":u,"has-error":p})},r.a.createElement("div",{className:"input-body flex-row justify-between"},r.a.createElement("div",{className:"flex-column justify-center position-relative w-100 px-2"},r.a.createElement("div",{className:"input-label"},a),r.a.createElement("input",{className:"input-value w-100",type:"text",value:n,onChange:function(e){return l(e.target.value)},onFocus:function(){return e.setState({isFocused:!0})},onBlur:function(){return e.setState({isFocused:!1})}})),o&&!p&&r.a.createElement("i",{className:"input-icon material-icons flex-row align-center mx-2"},o),p&&r.a.createElement("i",{className:"error-icon material-icons flex-row align-center mx-2"},"error")),r.a.createElement("hr",{className:"m-0"}),r.a.createElement("div",{className:"input-footer flex-row ml-2"},c&&!p&&r.a.createElement("span",{className:"helper-text text-ellipsis",title:c},c),p&&r.a.createElement("span",{className:"error-text text-ellipsis",title:s},s)))}}]),t}(r.a.Component));function I(){var e=N(),t=Object(s.a)(e,2);Object(A.a)(t[0]);var a=t[1].setUserData,c=Object(n.useState)("kekster2000"),o=Object(s.a)(c,2),u=o[0],m=o[1],p=Object(n.useState)("qwerty123"),f=Object(s.a)(p,2),d=f[0],b=f[1],v=Object(n.useState)(null),g=Object(s.a)(v,2),E=g[0],j=g[1],O=Object(i.g)(),w=(Object(i.h)().state||{from:{pathname:"/"}}).from;return r.a.createElement("div",{className:"form flex-column"},r.a.createElement(U,{label:"username",value:u,helperText:"username should be strong enough",errorText:E,icon:"face",onChange:function(e){return m(e)}}),r.a.createElement(U,{label:"password",value:d,helperText:"keep password simple",icon:"lock",onChange:function(e){return b(e)}}),r.a.createElement("button",{className:"button flex-row align-center justify-center",onClick:function(){(function(e){var t=e.username,a=e.password;return h("auth/login",{headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify({username:t,password:a})})})({username:u,password:d}).then((function(e){a(e),console.log("login ok",e),O.replace(w)})).catch((function(e){console.warn("login failed",e),j(e.message)}))}},r.a.createElement("span",null,"log in"),r.a.createElement("i",{className:"material-icons"},"arrow_forward")),r.a.createElement("span",{className:"p-2 flex-row justify-between"},"Don't have an account?",r.a.createElement(l.b,{to:"/register"},"register")))}function _(){var e=N(),t=Object(s.a)(e,2);Object(A.a)(t[0]);var a=t[1].setUserData,c=Object(n.useState)("jailbot007"),o=Object(s.a)(c,2),u=o[0],m=o[1],p=Object(n.useState)("kek123"),f=Object(s.a)(p,2),d=f[0],b=f[1],v=Object(n.useState)(null),g=Object(s.a)(v,2),E=g[0],j=g[1],O=Object(i.g)(),w=(Object(i.h)().state||{from:{pathname:"/"}}).from;return r.a.createElement("div",{className:"form flex-column"},r.a.createElement(U,{label:"username",value:u,helperText:"username should be strong enough",errorText:E,icon:"face",onChange:function(e){return m(e)}}),r.a.createElement(U,{label:"password",value:d,helperText:"keep password simple",icon:"lock",onChange:function(e){return b(e)}}),r.a.createElement("button",{className:"button flex-row align-center justify-center",onClick:function(){(function(e){var t=e.username,a=e.password;return h("auth/register",{headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify({username:t,password:a})})})({username:u,password:d}).then((function(e){a(e),console.log("register ok:",e),O.replace(w)})).catch((function(e){console.warn("register failed:",e.message),j(e.message)}))}},r.a.createElement("span",null,"register"),r.a.createElement("i",{className:"material-icons"},"add_box")),r.a.createElement("span",{className:"p-2 flex-row justify-between"},"Already have an account?",r.a.createElement(l.b,{to:"/login"},"log in")))}a(43);function J(){var e=N(),t=Object(s.a)(e,2),a=t[0],c=a.authToken,o=a.isAuthenticated,l=a.user,i=t[1],u=i.setUserData,m=i.clearUserData;return Object(n.useEffect)((function(){c&&!o&&function(e){return h("auth/status",{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({gameRoomId:!0,lastActivityTime:!0,isOnline:!0,authToken:!0,id:!0,name:!0})}).then((function(e){return e.data}))}(c).then(u).catch(m)}),[]),r.a.createElement("div",{className:"status flex-column align-end p-1"},o?r.a.createElement("div",{className:"flex-row align-center"},r.a.createElement("div",{className:"flex-row align-center mx-2"},r.a.createElement("i",{className:"material-icons px-1"},"face"),r.a.createElement("span",null,l.name)),r.a.createElement("button",{className:"button flex-row align-center px-3",onClick:m},r.a.createElement("span",null," log out"),r.a.createElement("i",{className:"material-icons"},"exit_to_app"))):r.a.createElement("div",null,"unauthorized"))}a(44);function F(e){var t=e.children,a=Object(v.a)(e,["children"]),n=N(),c=Object(s.a)(n,1)[0].isAuthenticated;return r.a.createElement(i.b,Object.assign({},a,{render:function(){return c?r.a.createElement(i.a,{to:"/"}):t}}))}a(45);function P(){var e=Object(i.g)(),t=N(),a=Object(s.a)(t,2),c=a[0].authToken;Object(A.a)(a[1]);var o=Object(n.useState)([]),l=Object(s.a)(o,2),u=l[0],m=l[1];return Object(n.useEffect)((function(){(function(e){return h("room/list",{headers:{"Content-type":"application/json",authToken:e},method:"GET"})})(c).then((function(e){m(e)}))}),[]),r.a.createElement("div",{className:"rooms form flex-column p-2"},r.a.createElement("h1",{className:"m-2"},"rooms"),r.a.createElement("ul",{className:"room-list list flex-column p-1 m-2"},u.map((function(t){return r.a.createElement("li",{className:"list-item flex-row align-center p-2 m-1",key:t.Id},r.a.createElement("span",{className:"room-name"},t.Name),r.a.createElement("div",{className:"flex-row align-center"},r.a.createElement("i",{className:"material-icons"},"group"),r.a.createElement("span",{className:"px-1"},t.UserCount),r.a.createElement("button",{className:"button",onClick:function(){return a=t.Id,void e.push("/rooms/".concat(encodeURIComponent(a)));var a}},"join")))}))),r.a.createElement("button",{className:"button flex-row align-center justify-center m-2",onClick:function(){e.push("/rooms/new")}},r.a.createElement("span",null,"create new room"),r.a.createElement("i",{className:"material-icons"},"add_box")))}function V(){var e=Object(i.i)()._roomId,t=decodeURIComponent(e);return r.a.createElement("div",{className:"form"},r.a.createElement("h1",null,"Now showing room ",t))}function B(){console.log("roomrouter");var e=Object(i.j)().path;return r.a.createElement(l.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:e},r.a.createElement(P,null)),r.a.createElement(i.b,{path:"".concat(e,"/new")},r.a.createElement("div",{className:"form"},"new room here")),r.a.createElement(i.b,{path:"".concat(e,"/:_roomId")},r.a.createElement(V,null))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement((function(){var e=N(),t=Object(s.a)(e,2),a=t[0],c=a.isOnline,o=(a.isAuthenticated,t[1].setOnline);return Object(n.useEffect)((function(){b.then((function(e){return o(!0)}))}),[]),r.a.createElement(l.a,null,r.a.createElement("div",{className:m()("app",{"is-online":c})},r.a.createElement(D,null),r.a.createElement(J,null),r.a.createElement(i.d,null,r.a.createElement(F,{path:"/login"},r.a.createElement(I,null)),r.a.createElement(F,{path:"/register"},r.a.createElement(_,null)),r.a.createElement(y,{path:"/rooms"},r.a.createElement(B,null)),r.a.createElement(i.b,{path:"/"},r.a.createElement(i.a,{to:"/rooms"})))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[28,1,2]]]);
//# sourceMappingURL=main.60793379.chunk.js.map