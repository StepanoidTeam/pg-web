(this["webpackJsonppg-web"]=this["webpackJsonppg-web"]||[]).push([[0],{38:function(e,t,n){e.exports=n.p+"static/media/wires-20.b1c5e4e0.svg"},39:function(e,t,n){e.exports=n.p+"static/media/connection-from.e75d5b32.svg"},40:function(e,t,n){e.exports=n.p+"static/media/connection-to.93da9075.svg"},41:function(e,t,n){e.exports=n.p+"static/media/path-cost-copper-10.e168a73f.svg"},42:function(e,t,n){e.exports=n.p+"static/media/path-cost-silver-20.ef391d38.svg"},43:function(e,t,n){e.exports=n.p+"static/media/path-cost-goldish-25.eebca72f.svg"},44:function(e,t,n){e.exports=n.p+"static/media/path-cost-gold.f70c738a.svg"},45:function(e){e.exports=JSON.parse('{"connectors":[{"id":"conn-1610","from":"mbombela","to":"germiston","cost":13},{"id":"conn-5363","from":"pretoria","to":"mbombela","cost":13},{"id":"conn-8586","from":"johannesburg","to":"germiston","cost":1},{"id":"conn-3377","from":"pretoria","to":"johannesburg","cost":2},{"id":"conn-5665","from":"pretoria","to":"polokwane","cost":11},{"id":"conn-8656","from":"musina","to":"polokwane","cost":8},{"id":"conn-9144","from":"musina","to":"mbombela","cost":15},{"id":"conn-6191","from":"johannesburg","to":"mbombela","cost":13},{"id":"conn-1607","from":"rustenburg","to":"johannesburg","cost":4},{"id":"conn-2223","from":"rustenburg","to":"pretoria","cost":4},{"id":"conn-0293","from":"klerksdorp","to":"johannesburg","cost":7},{"id":"conn-8263","from":"ladysmith","to":"germiston","cost":13},{"id":"conn-3560","from":"ladysmith","to":"johannesburg","cost":13},{"id":"conn-9788","from":"welkom","to":"klerksdorp","cost":5},{"id":"conn-9402","from":"kuruman","to":"klerksdorp","cost":12},{"id":"conn-0209","from":"kuruman","to":"rustenburg","cost":18},{"id":"conn-5734","from":"richards-bay","to":"ladysmith","cost":10},{"id":"conn-3660","from":"pietermaritzburg","to":"richards-bay","cost":9},{"id":"conn-2732","from":"durban","to":"richards-bay","cost":9},{"id":"conn-1252","from":"pietermaritzburg","to":"durban","cost":3},{"id":"conn-0251","from":"pietermaritzburg","to":"ladysmith","cost":5},{"id":"conn-9357","from":"pietermaritzburg","to":"mthatha","cost":12},{"id":"conn-1629","from":"durban","to":"mthatha","cost":13},{"id":"conn-7844","from":"east-london","to":"mthatha","cost":8},{"id":"conn-0299","from":"kimberley","to":"welkom","cost":9},{"id":"conn-3377","from":"kimberley","to":"kuruman","cost":8},{"id":"conn-6142","from":"springbok","to":"de-aar","cost":26},{"id":"conn-1268","from":"springbok","to":"beaufort-west","cost":24},{"id":"conn-3436","from":"springbok","to":"cape-town","cost":22},{"id":"conn-7188","from":"cape-town","to":"beaufort-west","cost":22},{"id":"conn-6624","from":"george","to":"de-aar","cost":17},{"id":"conn-6136","from":"beaufort-west","to":"de-aar","cost":10},{"id":"conn-7455","from":"beaufort-west","to":"george","cost":8},{"id":"conn-7327","from":"cape-town","to":"george","cost":16},{"id":"conn-0896","from":"port-elizabeth","to":"george","cost":12},{"id":"conn-0661","from":"port-elizabeth","to":"de-aar","cost":18},{"id":"conn-0182","from":"port-elizabeth","to":"east-london","cost":13},{"id":"conn-8205","from":"de-aar","to":"east-london","cost":22},{"id":"conn-9484","from":"upington","to":"kuruman","cost":11},{"id":"conn-6660","from":"upington","to":"springbok","cost":16},{"id":"conn-7872","from":"upington","to":"kimberley","cost":14},{"id":"conn-8091","from":"kimberley","to":"de-aar","cost":10},{"id":"conn-6803","from":"upington","to":"de-aar","cost":16},{"id":"conn-3770","from":"bloemfontein","to":"welkom","cost":6},{"id":"conn-4009","from":"bloemfontein","to":"kimberley","cost":6},{"id":"conn-7856","from":"bloemfontein","to":"ladysmith","cost":19},{"id":"conn-0695","from":"bloemfontein","to":"johannesburg","cost":16},{"id":"conn-9774","from":"bloemfontein","to":"mthatha","cost":18},{"id":"conn-5157","from":"bloemfontein","to":"de-aar","cost":13},{"id":"conn-4206","from":"bloemfontein","to":"east-london","cost":22},{"id":"conn-0563","from":"polokwane","to":"mbombela","cost":10}],"cities":[{"id":"upington","x":1155,"y":1075,"name":"upington","region":"red"},{"id":"port-elizabeth","x":1726,"y":1998,"name":"port elizabeth","region":"red"},{"id":"springbok","x":717,"y":1273,"name":"springbok","region":"red"},{"id":"de-aar","x":1567,"y":1620,"name":"de aar","region":"red"},{"id":"beaufort-west","x":1281,"y":1726,"name":"beaufort west","region":"red"},{"id":"cape-town","x":771,"y":1925,"name":"cape town","region":"red"},{"id":"george","x":1309,"y":2002,"name":"george","region":"red"},{"id":"east-london","x":2045,"y":1841,"name":"east london","region":"red"},{"id":"durban","x":2482,"y":1357,"name":"durban","region":"red"},{"id":"mthatha","x":2217,"y":1618,"name":"mthatha","region":"red"},{"id":"pietermaritzburg","x":2380,"y":1222,"name":"pietermaritzburg","region":"red"},{"id":"kuruman","x":1462,"y":901,"name":"kuruman","region":"red"},{"id":"musina","x":2442,"y":246,"name":"musina","region":"red"},{"id":"mbombela","x":2478,"y":615,"name":"mbombela","region":"red"},{"id":"polokwane","x":2254,"y":390,"name":"polokwane","region":"red"},{"id":"pretoria","x":2138,"y":576,"name":"pretoria","region":"red"},{"id":"germiston","x":2348,"y":813,"name":"germiston","region":"red"},{"id":"johannesburg","x":2123,"y":787,"name":"johannesburg","region":"red"},{"id":"rustenburg","x":1895,"y":706,"name":"rustenburg","region":"red"},{"id":"klerksdorp","x":1879,"y":835,"name":"klerksdorp","region":"red"},{"id":"ladysmith","x":2315,"y":1087,"name":"ladysmith","region":"red"},{"id":"welkom","x":1861,"y":1017,"name":"welkom","region":"red"},{"id":"richards-bay","x":2649,"y":1137,"name":"richards-bay","region":"red"},{"id":"kimberley","x":1628,"y":1183,"name":"kimberley","region":"red"},{"id":"bloemfontein","x":1872,"y":1215,"name":"bloemfontein","region":"red"}]}')},48:function(e,t,n){e.exports=n(75)},65:function(e,t,n){},66:function(e){e.exports=JSON.parse('{"name":"pg-web","homepage":"https://stepanoidteam.github.io/pg-web","version":"0.1.11","private":true,"scripts":{"start":"PORT=3001 react-scripts start","deploy":"gh-pages -d build -m deployment","predeploy":"npm version patch -f && npm run build","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"dependencies":{"@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.4.0","@testing-library/user-event":"^7.2.1","classnames":"^2.2.6","firebase":"^7.9.0","lodash":"^4.17.15","react":"^16.12.0","react-dom":"^16.12.0","react-router-dom":"^5.1.2","react-scripts":"3.4.0","source-map-explorer":"^2.2.2","use-global-hook":"^0.1.12"},"eslintConfig":{"extends":"react-app","rules":{"no-empty-pattern":"off","react-hooks/exhaustive-deps":"off","no-unused-vars":"off","no-unreachable":"off","jsx-a11y/accessible-emoji":"off"}},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"gh-pages":"^2.2.0"}}')},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(33),c=n.n(r),i=n(14),s=(n(53),n(55),n(57),n(9)),l=n(1),m=n(5),u=n(15),d=n(24),f=n.n(d),p=n(11),b=n(16),h=n(3),g=n(34),v=n(17),y=n(18),x=function(){function e(){Object(v.a)(this,e)}return Object(y.a)(e,null,[{key:"set",value:function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=new Date(Date.now()+a*e.msDay);document.cookie="".concat(t,"=").concat(n,";expires=").concat(o.toUTCString(),";path=/")}},{key:"get",value:function(e){var t=document.cookie.split("; ").map((function(e){return e.split("=")})).find((function(t){var n=Object(l.a)(t,2),a=n[0];n[1];return a===e}))||[null,null];return Object(l.a)(t,2)[1]}},{key:"delete",value:function(e){var t=new Date(0);document.cookie="".concat(e,"=;expires=").concat(t.toUTCString(),";path=/")}},{key:"clear",value:function(){document.cookie.split("; ").map((function(e){return e.split("=")})).forEach((function(t){var n=Object(l.a)(t,1)[0];return e.delete(n)}))}}]),e}();x.msDay=864e5;var w={isOnline:!1,apiVersion:null,authToken:x.get("authToken"),isAuthenticated:!1,user:null,counter:0,rooms:[],game:{GameRoomId:null,playerBoards:[]},connectors:[],cities:[]};function E(e,t){var n=t.Id;return[e.state.game.playerBoards.find((function(e){return e.Id===n})),function(t){e.setState({game:Object(h.a)({},e.state.game,{playerBoards:[].concat(Object(b.a)(e.state.game.playerBoards.filter((function(e){return e.Id!==n}))),[t])})})}]}var j={setOnline:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.setState({isOnline:t})},setApiVersion:function(e,t){e.setState({apiVersion:t})},addToCounter:function(e,t){e.setState({counter:e.state.counter+1})},setUserData:function(e,t){var n=t.AuthToken,a=t.Id,o=(t.Name,t.GameRoomId),r=(t.displayName,t.email);t.emailVerified,t.photoURL,t.isAnonymous,t.uid,t.providerDat;e.setState({authToken:n,user:{id:a,name:r},isAuthenticated:!0,game:Object(h.a)({},e.state.game,{GameRoomId:o})}),x.set("authToken",n)},clearUserData:function(e){e.setState({authToken:null,user:null,isAuthenticated:!1}),x.delete("authToken")},setRooms:function(e,t){e.setState({rooms:t})},setUserJoin:function(e,t){var n=E(e,{Id:t.Id});(0,Object(l.a)(n,2)[1])(Object(h.a)({},t,{EntityType:"PlayerBoard",Color:0,IsDone:!0,Money:0}))},setUserLeave:function(e,t){var n=t.Id;e.setState({game:Object(h.a)({},e.state.game,{playerBoards:Object(b.a)(e.state.game.playerBoards.filter((function(e){return e.Id!==n})))})})},setPlayerBoards:function(e,t){e.setState({game:Object(h.a)({},e.state.game,{playerBoards:t})})},setPlayerColor:function(e,t){var n=t.Id,a=t.Color,o=E(e,{Id:n}),r=Object(l.a)(o,2),c=r[0],i=r[1];if(!c)return console.warn("".concat(n," not found"));c.Color=a,i(c)},setPlayerIsDone:function(e,t){var n=t.Id,a=t.IsDone,o=E(e,{Id:n}),r=Object(l.a)(o,2),c=r[0],i=r[1];if(!c)return console.warn("".concat(n," not found"));c.IsDone=a,i(c)},setCities:function(e,t){e.setState({cities:t})},setConnectors:function(e,t){e.setState({connectors:t})}},O=Object(g.a)(o.a,w,j);function k(e){var t=e.children,n=Object(p.a)(e,["children"]),a=O(),r=Object(l.a)(a,1)[0].isAuthenticated;return o.a.createElement(u.b,Object.assign({},n,{render:function(e){var n=e.location;return r?t:o.a.createElement(u.a,{to:{pathname:"/login",state:{from:n}}})}}))}var N=n(13),C=n.n(N),S=n(19),T="https://pg-api.azurewebsites.net/api";function I(e){return D.apply(this,arguments)}function D(){return(D=Object(S.a)(C.a.mark((function e(t){var n,a,o,r,c,i=arguments;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=i.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=i[o];return e.next=4,fetch.apply(void 0,["".concat(T,"/").concat(t)].concat(a));case 4:if((r=e.sent).ok){e.next=9;break}return e.next=8,r.json();case 8:throw e.sent;case 9:return e.next=11,r.json();case 11:return c=e.sent,e.abrupt("return",c.data);case 15:return e.prev=15,e.t0=e.catch(0),console.warn("api error",e.t0),e.abrupt("return",Promise.reject(e.t0));case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function U(){return(U=Object(S.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I("version").then((function(e){return e.version})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(65);var B=n(66).version;function A(){var e=O(),t=Object(l.a)(e,2),n=t[0].apiVersion,r=t[1].setApiVersion;return Object(a.useEffect)((function(){(function(){return U.apply(this,arguments)})().then((function(e){r(e)}))}),[]),o.a.createElement("div",{className:"version-holder flex-column m-1 z-index-1"},o.a.createElement("span",null,"web: ",B),o.a.createElement("span",null,"\ud83d\udd25api: ",n))}var P=n(46),L=n(37),R=n(47),z=(n(67),function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(P.a)(this,Object(L.a)(t).call(this,e))).state={isFocused:!1},n}return Object(R.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.label,a=t.value,r=t.helperText,c=t.icon,i=t.errorText,s=t.onChange,l=this.state.isFocused,m=0===a.length,u=!!i;return o.a.createElement("label",{className:f()("input cursor-pointer",{"is-focused":l,"is-empty":m,"has-error":u})},o.a.createElement("div",{className:"input-body flex-row justify-between"},o.a.createElement("div",{className:"flex-column justify-center position-relative w-100 px-2"},o.a.createElement("div",{className:"input-label"},n),o.a.createElement("input",{className:"input-value w-100",type:"text",value:a,onChange:function(e){return s(e.target.value)},onFocus:function(){return e.setState({isFocused:!0})},onBlur:function(){return e.setState({isFocused:!1})}})),c&&!u&&o.a.createElement("i",{className:"input-icon material-icons flex-row align-center mx-2"},c),u&&o.a.createElement("i",{className:"error-icon material-icons flex-row align-center mx-2"},"error")),o.a.createElement("hr",{className:"m-0"}),o.a.createElement("div",{className:"input-footer flex-row ml-2"},r&&!u&&o.a.createElement("span",{className:"helper-text text-ellipsis",title:r},r),u&&o.a.createElement("span",{className:"error-text text-ellipsis",title:i},i)))}}]),t}(o.a.Component));function J(){var e=O(),t=Object(l.a)(e,2);Object(s.a)(t[0]);var n=t[1].setUserData,r=Object(a.useState)("kekster2000@example.com"),c=Object(l.a)(r,2),d=c[0],f=c[1],p=Object(a.useState)("qwerty123"),b=Object(l.a)(p,2),h=b[0],g=b[1],v=Object(a.useState)(null),y=Object(l.a)(v,2),x=y[0],w=y[1],E=Object(u.g)(),j=(Object(u.h)().state||{from:{pathname:"/"}}).from;return o.a.createElement("div",{className:"form flex-column"},o.a.createElement(z,{label:"username",value:d,helperText:"username should be strong enough",errorText:x,icon:"face",onChange:function(e){return f(e)}}),o.a.createElement(z,{label:"password",value:h,helperText:"keep password simple",icon:"lock",onChange:function(e){return g(e)}}),o.a.createElement("button",{className:"button flex-row center-center",onClick:function(){i.auth().signInWithEmailAndPassword(d,h).then((function(e){console.debug("\ud83d\udd25login ok",e),n(e.user),E.replace(j)})).catch((function(e){console.warn("\ud83d\udd25login failed",e),w(e.message)}))}},o.a.createElement("span",null,"log in"),o.a.createElement("i",{className:"material-icons"},"arrow_forward")),o.a.createElement("span",{className:"p-2 flex-row justify-between"},"Don't have an account?",o.a.createElement(m.b,{to:"/register"},"register")))}function M(){var e=O(),t=Object(l.a)(e,2);Object(s.a)(t[0]);var n=t[1].setUserData,r=Object(a.useState)("jailbot007"),c=Object(l.a)(r,2),d=c[0],f=c[1],p=Object(a.useState)("kek123"),b=Object(l.a)(p,2),h=b[0],g=b[1],v=Object(a.useState)(null),y=Object(l.a)(v,2),x=y[0],w=y[1],E=Object(u.g)(),j=(Object(u.h)().state||{from:{pathname:"/"}}).from;return o.a.createElement("div",{className:"form flex-column"},o.a.createElement(z,{label:"username",value:d,helperText:"username should be strong enough",errorText:x,icon:"face",onChange:function(e){return f(e)}}),o.a.createElement(z,{label:"password",value:h,helperText:"keep password simple",icon:"lock",onChange:function(e){return g(e)}}),o.a.createElement("button",{className:"button flex-row center-center",onClick:function(){i.auth().createUserWithEmailAndPassword(d,h).then((function(e){console.log("\ud83d\udd25auth",e.user),n(e),E.replace(j)})).catch((function(e){console.warn("\ud83d\udd25register failed:",e),w(e.message)}))}},o.a.createElement("span",null,"register"),o.a.createElement("i",{className:"material-icons"},"add_box")),o.a.createElement("span",{className:"p-2 flex-row justify-between"},"Already have an account?",o.a.createElement(m.b,{to:"/login"},"log in")))}n(68);function _(){var e=Object(u.g)(),t=O(),n=Object(l.a)(t,2),r=n[0],c=r.authToken,i=r.isAuthenticated,s=r.user,m=n[1],d=m.setUserData,f=m.clearUserData;return Object(a.useEffect)((function(){c&&!i&&function(e){return I("auth/status",{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({gameRoomId:!0,lastActivityTime:!0,isOnline:!0,authToken:!0,id:!0,name:!0})}).then((function(e){return e.data}))}(c).then((function(t){d(t),t.GameRoomId&&e.push("rooms/".concat(encodeURIComponent(t.GameRoomId)))})).catch(f)}),[]),o.a.createElement("div",{className:"status-holder flex-column align-end p-1 z-index-1"},i?o.a.createElement("div",{className:"flex-row align-center"},o.a.createElement("div",{className:"flex-row align-center mx-2"},o.a.createElement("i",{className:"material-icons px-1"},"face"),o.a.createElement("span",null,s.name)),o.a.createElement("button",{className:"button flex-row align-center px-3",onClick:f},o.a.createElement("span",null," log out"),o.a.createElement("i",{className:"material-icons"},"exit_to_app"))):o.a.createElement("div",null,"unauthorized"))}function F(e){var t=e.children,n=Object(p.a)(e,["children"]),a=O(),r=Object(l.a)(a,1)[0].isAuthenticated;return o.a.createElement(u.b,Object.assign({},n,{render:function(){return r?o.a.createElement(u.a,{to:"/"}):t}}))}n(69);function W(){var e=Object(u.g)(),t=O(),n=Object(l.a)(t,2),r=n[0],c=r.authToken,s=r.rooms,m=n[1].setRooms,d=function(t){(function(e,t){return I("room/join",{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({roomId:t})})})(c,t).then((function(n){e.push("/rooms/".concat(encodeURIComponent(t)))}))};return Object(a.useEffect)((function(){i.database().ref("/rooms").on("value",(function(e){console.log("\ud83d\udd25",e.val());var t=Object.values(e.val());m(t)}))}),[]),o.a.createElement("div",{className:"rooms form flex-column p-2"},o.a.createElement("h1",{className:"mx-2"},"rooms"),o.a.createElement("ul",{className:"room-list list flex-column p-1 m-2"},s.map((function(e){return o.a.createElement("li",{className:"list-item flex-row align-center p-2 m-1",key:e.Id},o.a.createElement("span",{className:"room-name fill-left"},e.Name),o.a.createElement("div",{className:"flex-row align-center"},o.a.createElement("i",{className:"material-icons"},"group"),o.a.createElement("span",{className:"px-1"},e.UserCount),o.a.createElement("button",{className:"button",onClick:function(){return d(e.Id)}},"join")))}))),o.a.createElement("button",{className:"button flex-row center-center m-2",onClick:function(){e.push("/rooms/new")}},o.a.createElement("span",null,"create new room"),o.a.createElement("i",{className:"material-icons"},"add_box")))}var G=n(6);function H(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return I("game/toggleReady",{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({state:t})})}function V(){var e=Object(u.i)()._roomId,t=Object(u.g)(),n=decodeURIComponent(e),r=O(),c=Object(l.a)(r,2),i=c[0],s=i.authToken,m=i.rooms,d=i.game,f=c[1].setPlayerBoards,p=d.playerBoards;Object(a.useEffect)((function(){(function(e){return I("game/status",{headers:{"Content-type":"application/json",authToken:e},method:"GET"})})(s).then((function(e){f(e.PlayerBoards)}))}),[]);var b=m.find((function(e){return e.Id===n}));if(!b)return null;var h=function(e){(function(e,t){return I("game/changeColor",{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({userId:t})})})(s,e).then((function(){}))},g=function(e){(function(e,t){return I("room/kick?username=".concat(t),{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({username:t})})})(s,e).then((function(){}))},v=Object(G.sortBy)(p,"Id"),y=v.every((function(e){return e.IsDone}));return o.a.createElement("div",{className:"form flex-column p-2"},o.a.createElement("h1",{className:"flex-row mx-2"},o.a.createElement("span",{className:"fill-left"},b.Name),o.a.createElement("div",{className:"flex-row align-center"},o.a.createElement("i",{className:"material-icons"},"group"),o.a.createElement("span",{className:"px-1"},v.length))),o.a.createElement("ul",{className:"player-list list flex-column p-1 m-2"},v.map((function(e){return o.a.createElement("li",{className:"list-item flex-row align-center p-2 m-1",key:e.Id},o.a.createElement("div",{className:"player-name flex-row fill-left align-center"},o.a.createElement("i",{className:"city-icon color-".concat(e.Color," cursor-pointer"),onClick:function(){return h(e.Id)}}),o.a.createElement("span",{className:"px-2"},e.Name)),o.a.createElement("i",{className:"material-icons cursor-pointer mx-2",onClick:function(){return g(e.Name)}},"delete"),o.a.createElement("i",{className:"material-icons cursor-pointer mx-1",style:{color:e.IsDone?"gold":"gray"},onClick:function(){return function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];H(s,t).then((function(){}))}(e.Id,!e.IsDone)}},e.IsDone?"thumb_up":"thumb_down"))}))),o.a.createElement("div",{className:"flex-row align-center"},o.a.createElement("button",{className:"button mx-1",onClick:function(){(function(e){return I("room/leave",{headers:{"Content-type":"application/json",authToken:e},method:"POST"})})(s).then((function(){t.push("/rooms")}))}},"leave"),o.a.createElement("div",{className:"fill-left"}),o.a.createElement("button",{className:"button mx-1",onClick:function(){}},"add bot"),o.a.createElement("button",{className:"button mx-1",disabled:!y,onClick:function(){}},"start game")))}function Y(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(u.g)(),i=O(),d=Object(l.a)(i,2),f=d[0].authToken;Object(s.a)(d[1]),Object(a.useEffect)((function(){(function(e){return I("maps/list",{headers:{"Content-type":"application/json",authToken:e},method:"GET"})})().then((function(e){r(e)}))}),[]);return o.a.createElement("div",{className:"form flex-column p-2"},o.a.createElement("h1",{className:"flex-row mx-2"},o.a.createElement("span",{className:"fill-left"},"select map")),o.a.createElement("ul",{className:"map-list list flex-column p-1 m-2",style:{width:320}},n.map((function(e){return o.a.createElement("li",{className:"list-item flex-row align-center p-2 m-1",key:e},o.a.createElement("span",{className:"fill-left"},e),o.a.createElement("button",{className:"button",onClick:function(){return t=e,void c.push("/maps/".concat(t));var t}},"preview"))}))),o.a.createElement("div",{className:"flex-row align-center"},o.a.createElement(m.b,{to:"/rooms"},o.a.createElement("button",{className:"button mx-1"},"quit")),o.a.createElement("div",{className:"fill-left"}),o.a.createElement("button",{className:"button mx-1",onClick:function(){(function(e,t){return I("room/create",{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({})})})(f).then((function(){}))}},"create room")))}function q(){var e=Object(u.j)().path;return o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:e},o.a.createElement(W,null)),o.a.createElement(u.b,{path:"".concat(e,"/new")},o.a.createElement(Y,null)),o.a.createElement(u.b,{path:"".concat(e,"/:_roomId")},o.a.createElement(V,null)))}n(71);function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.startsWith("{")?e:e.substring(e.indexOf("{"))}var K=new(function(){function e(){Object(v.a)(this,e),this.ws=null}return Object(y.a)(e,[{key:"reducer",value:function(e){var t=Object(l.a)(this.globals,2);Object(s.a)(t[0]);var n=t[1],a=n.setPlayerColor,o=n.setPlayerIsDone,r=n.setUserJoin,c=n.setUserLeave;switch(e.BroadcastReason){case"/api/game/changecolor":a(Object(l.a)(e.PlayerBoards,1)[0]);break;case"/api/game/toggleready":o(Object(l.a)(e.PlayerBoards,1)[0]);break;case"/api/room/join":if(!e.Users)return;r(Object(l.a)(e.Users,1)[0]);break;case"/api/room/kick":case"/api/room/leave":if(!e.Users)return;c(Object(l.a)(e.Users,1)[0]);break;default:console.warn("unhandled reason",e.BroadcastReason,e)}}},{key:"connect",value:function(){var e=Object(S.a)(C.a.mark((function e(t){var n,a,o,r,c=this;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.globals=t,n=Object(l.a)(t,2),a=n[0].authToken,o=n[1].setOnline,"\ud83c\udf10ws:",r=function e(t){var n=JSON.parse(X(t.data)||null);switch(console.debug("\ud83c\udf10ws:",t.type,n),t.type){case"message":c.reducer(n);break;case"open":c.ws.addEventListener("close",e),c.ws.addEventListener("message",e),o(!0),c.send({AuthToken:a,Type:"AUTHSTATUS"});break;case"close":c.ws.removeEventListener("open",e),c.ws.removeEventListener("message",e),o(!1)}},this.ws=new WebSocket("wss://pg-api.azurewebsites.net/api"),this.ws.addEventListener("open",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"send",value:function(e){this.ws.send(JSON.stringify(e))}},{key:"disconnect",value:function(){this.ws.close()}}]),e}());function $(e){var t=e.children,n=e.onStart,a=void 0===n?G.noop:n,r=e.onDrag,c=void 0===r?G.noop:r,i=e.onDrop,s=void 0===i?G.noop:i,l=Object(p.a)(e,["children","onStart","onDrag","onDrop"]),m=window.document.querySelector(".map-content"),u=function(e){var t=m.getBoundingClientRect(),n=t.x,a=t.y,o=e.x,r=e.y;return{x:(o-n)/(window.scale||1),y:(r-a)/(window.scale||1)}},d=function(e){e.stopPropagation(),c(u(e))},f=function e(t){t.stopPropagation(),s(u(t)),m.removeEventListener("mousemove",d),m.removeEventListener("mouseup",e)};return o.a.createElement("div",Object.assign({onMouseDown:function(e){e.stopPropagation(),m.addEventListener("mousemove",d,{passive:!1}),m.addEventListener("mouseup",f,{passive:!1}),a(u(e))}},l),t)}n(72);function Q(e){var t=e.cost;return o.a.createElement("div",{className:"city-slot m-1 text-stroke"},o.a.createElement("span",{className:"select-none"},t))}function Z(e){var t=e.x,n=e.y,r=e.name,c=e.region,i=e.onUpdateCity,s=Object(a.useState)(r),m=Object(l.a)(s,2),u=m[0],d=m[1],f=Object(a.useState)({x:t,y:n}),p=Object(l.a)(f,2),b=p[0],g=p[1];return o.a.createElement($,{className:"overlay flex-row justify-center align-center",style:{left:b.x,top:b.y},onDrag:function(e){g(e),i(Object(h.a)({},e))},onDrop:function(){},title:"".concat(b.x,",").concat(b.y)},o.a.createElement("div",{className:"city-card"},o.a.createElement("div",{className:"city-rows flex-column p-1"},o.a.createElement("div",{className:"city-slots flex-row"},[10,15,20].map((function(e){return o.a.createElement(Q,{key:e,cost:e})}))),o.a.createElement("div",{className:"position-relative"},o.a.createElement("div",{className:"overlay w-100 h-100 flex-row center-center"},o.a.createElement("div",{className:"city-name region-".concat(c," px-1 text-stroke select-none"),onClick:function(){var e=prompt("set city name",u);d(e),i({name:e})}},u))),o.a.createElement("div",{className:"city-slots flex-row",hidden:!0},[10,15,20].map((function(e){return o.a.createElement(Q,{key:e,cost:e})}))))))}var ee=n(38),te=n.n(ee),ne=n(39),ae=n.n(ne),oe=n(40),re=n.n(oe);function ce(e,t){return Math.pow(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2),.5)}for(var ie=[],se=190/3,le=150/1,me=0;me<3;me++)for(var ue=0;ue<1;ue++)ie.push({x:se*(me-1),y:le*(ue-0)});var de=n(41),fe=n.n(de),pe=n(42),be=n.n(pe),he=n(43),ge=n.n(he),ve=n(44),ye=n.n(ve);function xe(e){var t=e.from,n=e.to,a=e.cost,r=e.onUpdateConnector,c=function(e,t){var n=ie.map((function(t){return{x:e.x+t.x,y:e.y+t.y}})),a=ie.map((function(e){return{x:t.x+e.x,y:t.y+e.y}})),o=[];n.forEach((function(e){a.forEach((function(t){o.push([e,t,ce(e,t)])}))}));var r=Object(G.minBy)(o,(function(e){return Object(l.a)(e,3)[2]})),c=Object(l.a)(r,3);return[c[0],c[1],c[2]]}(t,n),i=Object(l.a)(c,3),s=i[0],m=i[1],u=i[2],d=function(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}(s,m),f=180*Math.atan2(m.y-s.y,m.x-s.x)/Math.PI,p=0,b=-10,h=-60,g=-16,v=40,y=30,x=function(e){return e<10?fe.a:e<20?be.a:e<25?ge.a:ye.a}(a);return o.a.createElement("g",{className:"filter-shadow-connection"},o.a.createElement("rect",{height:"20",width:u,x:s.x,y:s.y,viewBox:"0 0 100 100",viewTarget:"0 0 100 100",transform:"translate(".concat(p," ").concat(b,") rotate(").concat(f," ").concat(s.x-p," ").concat(s.y-b,")"),style:{fill:"url(#wires-pattern)"}}),o.a.createElement("image",{x:s.x,y:s.y,width:v,height:y,xlinkHref:ae.a,transform:"translate(".concat(-h/2.5," ").concat(g,") rotate(").concat(f," ").concat(s.x+h/2.5," ").concat(s.y-g,")")}),o.a.createElement("image",{x:m.x,y:m.y,width:v,height:y,xlinkHref:re.a,transform:"translate(".concat(h," ").concat(g,") rotate(").concat(f," ").concat(m.x-h," ").concat(m.y-g,")")}),o.a.createElement("image",{x:d.x-22.5,y:d.y-22.5,width:45,height:45,xlinkHref:x}),o.a.createElement("foreignObject",{x:d.x-22.5,y:d.y-22.5,width:45,height:45,className:"filter-shadow-text",onClick:function(){var e=+prompt("set new cost",a);r({cost:e})}},o.a.createElement("div",{className:"flex-row center-center h-100"},o.a.createElement("span",{className:"connection-cost text-stroke"},a))),o.a.createElement("circle",{cx:s.x,cy:s.y,r:"15",style:{fill:"greenyellow",opacity:.7}}),o.a.createElement("circle",{cx:m.x,cy:m.y,r:"15",style:{fill:"red",opacity:.7}}))}n(73);var we=["red","teal","brown","yellow","green","violet","orange"];var Ee=n(45);function je(){Object(u.i)().mapId;var e=O(),t=Object(l.a)(e,2),n=t[0],r=(n.authToken,n.connectors),c=n.cities,i=t[1],s=i.setConnectors,m=i.setCities,d=Object(a.useState)({x:0,y:0}),f=Object(l.a)(d,2),g=f[0],v=f[1],y=Object(a.useState)(!1),x=Object(l.a)(y,2),w=x[0],E=x[1];Object(a.useEffect)((function(){var e=Ee;console.log("\ud83d\uddfe",e),window.mapData=e;var t=e.cities,n=e.connectors;m(t),s(n),function(){var e,t,n=null,a=1,o=0,r=0,c=document.querySelector(".map-overlay"),i=document.querySelector(".map-content"),s=function(){window.requestAnimationFrame((function(){var e=c.offsetWidth,t=c.offsetHeight,n=i.getBoundingClientRect(),s=n.width,l=n.height;o=Object(G.clamp)(o,Math.min(0,e-s),Math.max(0,e-s)),r=Object(G.clamp)(r,Math.min(0,t-l),Math.max(0,t-l));var m="translate3D(".concat(o,"px, ").concat(r,"px, 0px) scale(").concat(a,")");window.scale=a,i.style.transform=m})),document.title="".concat(a)},m=!1;function u(c){if(c.preventDefault(),m=!0,document.body.classList.add("cursor-move"),c instanceof TouchEvent){var i=Object(l.a)(c.touches,1)[0];e=i.pageX-o,t=i.pageY-r}else e=c.pageX-o,t=c.pageY-r;n=a}function d(c){if(c.preventDefault(),m){if(c instanceof TouchEvent){var i=Object(l.a)(c.touches,1)[0];console.log(c.touches),a=n*(i.scale||1),o=i.pageX-e,r=i.pageY-t}else a=n*(c.scale||1),o=c.pageX-e,r=c.pageY-t;s()}}function f(e){e.preventDefault(),m=!1,document.body.classList.remove("cursor-move")}window.addEventListener("wheel",(function(e){e.preventDefault(),e.ctrlKey?(a-=.01*e.deltaY,a=Math.max(.2,a),a=Math.min(1.5,a)):(o-=2*e.deltaX,r-=2*e.deltaY),s()}),{passive:!1}),window.addEventListener("gesturestart",u,{passive:!1}),window.addEventListener("gesturechange",d,{passive:!1}),window.addEventListener("gestureend",f,{passive:!1}),window.addEventListener("mousedown",u,{passive:!1}),window.addEventListener("mousemove",d,{passive:!1}),window.addEventListener("mouseup",f,{passive:!1}),console.log("zoom init done")}()}),[]);var j=function(){return Date.now().toString().substr(-4)};var k=function(e){s(r.filter((function(t){return![t.from,t.to].includes(e)})))};return o.a.createElement("div",null,o.a.createElement("div",{className:"map-overlay"},o.a.createElement("div",{className:"map-content map-bg",style:{width:3500,height:2400}},o.a.createElement("svg",{className:"map-svg w-100 h-100",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},o.a.createElement("defs",null,o.a.createElement("pattern",{id:"wires-pattern",height:"100%",width:"100%",viewBox:"0 0 20 20",patternContentUnits:"objectBoundingBox",preserveAspectRatio:"none"},o.a.createElement("image",{width:"20",height:"20",preserveAspectRatio:"xMidYMid slice",xlinkHref:te.a})),o.a.createElement("filter",{id:"filter-shadow-connection"},o.a.createElement("feDropShadow",{stdDeviation:"0 0",dx:"2",dy:"2",floodColor:"#00000040"})),o.a.createElement("filter",{id:"filter-shadow-text select-none"},o.a.createElement("feDropShadow",{stdDeviation:"0 0",dx:"1",dy:"1",floodColor:"#000000cc"}))),r.map((function(e){var t=c.find((function(t){return t.id===e.from})),n=c.find((function(t){return t.id===e.to}));return o.a.createElement(xe,{key:e.id,from:t,to:n,cost:e.cost,onUpdateConnector:function(t){return function(e){var t=e.id,n=Object(p.a)(e,["id"]),a=r.find((function(e){return e.id===t})),o=Object(h.a)({},a,{},n);isFinite(o.cost)?s([].concat(Object(b.a)(r.filter((function(e){return e.id!==t}))),[o])):s(r.filter((function(e){return e.id!==t})))}(Object(h.a)({id:e.id},t))}})}))),c.map((function(e){return o.a.createElement(Z,{key:e.id,x:e.x,y:e.y,name:e.name,region:e.region,onUpdateCity:function(t){return function(e){var t=e.id,n=Object(p.a)(e,["id"]),a=c.find((function(e){return e.id===t})),o=Object(h.a)({},a,{},n);o.name&&0!==o.name.length?(m([].concat(Object(b.a)(c.filter((function(e){return e.id!==t}))),[o])),s(r)):(console.log("city delete"),k(o.id),m(c.filter((function(e){return e.id!==t}))))}(Object(h.a)({id:e.id},t))}})})),o.a.createElement("div",{className:"overlay flex-row center-center",hidden:!w,style:{left:g.x,top:g.y}},o.a.createElement("div",{className:"tool-cursor overlay"},"add here")))),o.a.createElement("div",{className:"map-tools overlay flex-row z-index-1 p-2"},o.a.createElement("button",{className:"p-2 ml-2",onClick:function(){var e=localStorage.getItem("map");if(e){var t=JSON.parse(e),n=t.connectors,a=t.cities;m(a),s(n),console.log("map loaded")}else console.log("map not found")}},"load map"),o.a.createElement("button",{className:"p-2 ml-2",onClick:function(){var e={connectors:r,cities:c};localStorage.setItem("map",JSON.stringify(e)),console.log("map saved to ls")}},"save map"),o.a.createElement("button",{className:"p-2 ml-2",onClick:function(){m([]),s([]),console.log("map cleared")}},"clear map"),o.a.createElement("button",{className:"p-2 ml-2",onClick:function(){var e=c.reverse(),t=Object(l.a)(e,2),n=t[0],a=t[1];if(n&&a){var o=prompt("from",n.id),i=prompt("to",a.id),m=+prompt("cost",10);if(o&&i&&isFinite(m)&&c.some((function(e){return[o,i].includes(e.id)}))){var u={id:"conn-".concat(j()),from:o,to:i,cost:m};s([].concat(Object(b.a)(r),[u]))}}else console.log("no cities")}},"add connector"),o.a.createElement($,{onStart:function(e){e.x,e.y},onDrag:function(e){v(e),E(!0)},onDrop:function(e){!function(e){var t=e.x,n=e.y,a=e.name,o=(void 0===a?"":a)||prompt("enter name","city ".concat(j()));if(o){var r={id:Object(G.kebabCase)(o),x:t,y:n,name:o,region:we[0]};m([].concat(Object(b.a)(c),[r]))}}(Object(h.a)({},e)),v({x:0,y:0}),E(!1)}},o.a.createElement("button",{className:"p-2 ml-2"},"add city"))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(74);i.initializeApp({apiKey:"AIzaSyBrLjfuTRzphTHh_9V7Aik-jTLylWfAnt0",authDomain:"power-grid-c1320.firebaseapp.com",databaseURL:"https://power-grid-c1320.firebaseio.com",projectId:"power-grid-c1320",storageBucket:"power-grid-c1320.appspot.com",messagingSenderId:"458551111011",appId:"1:458551111011:web:58bbe6f37b886a81c73756"}),c.a.render(o.a.createElement((function(){var e=O(),t=Object(l.a)(e,2),n=t[0].isOnline;return Object(s.a)(t[1]),Object(a.useEffect)((function(){n||K.connect(e)}),[n]),o.a.createElement(m.a,null,o.a.createElement("div",{className:f()("app",{"is-online":n})},o.a.createElement(A,null),o.a.createElement(_,null),o.a.createElement(u.d,null,o.a.createElement(F,{path:"/login"},o.a.createElement(J,null)),o.a.createElement(F,{path:"/register"},o.a.createElement(M,null)),o.a.createElement(k,{path:"/rooms"},o.a.createElement(q,null)),o.a.createElement(u.b,{path:"/maps/:mapId"},o.a.createElement(je,null)),o.a.createElement(u.b,{path:"/"},o.a.createElement(u.a,{to:"/rooms"})))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[48,1,2]]]);
//# sourceMappingURL=main.4f50a56d.chunk.js.map