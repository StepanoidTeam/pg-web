(this["webpackJsonppg-web"]=this["webpackJsonppg-web"]||[]).push([[0],{28:function(e,t,n){e.exports=n(44)},33:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(24),o=n.n(c),l=(n(33),n(1)),s=n(6),i=n(8),u=n(14),m=n.n(u),f=n(9),p=n.n(f),h="https://pg-api.azurewebsites.net/api";function d(e){var t,n,a,r,c,o=arguments;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:for(l.prev=0,t=o.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=o[a];return l.next=4,p.a.awrap(fetch.apply(void 0,["".concat(h,"/").concat(e)].concat(n)));case 4:if((r=l.sent).ok){l.next=9;break}return l.next=8,p.a.awrap(r.json());case 8:throw l.sent;case 9:return l.next=11,p.a.awrap(r.json());case 11:return c=l.sent,l.abrupt("return",c.data);case 15:return l.prev=15,l.t0=l.catch(0),console.warn("api error",l.t0),l.abrupt("return",Promise.reject(l.t0));case 19:case"end":return l.stop()}}),null,null,[[0,15]])}var b=p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d("version").then((function(e){return e.version})));case 1:case"end":return e.stop()}})),v=n(15),E=n(27),g=n(10),j=n(11),O=function(){function e(){Object(g.a)(this,e)}return Object(j.a)(e,null,[{key:"set",value:function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new Date(Date.now()+a*e.msDay);document.cookie="".concat(t,"=").concat(n,";expires=").concat(r.toUTCString(),";path=/")}},{key:"get",value:function(e){var t=document.cookie.split(";").map((function(e){return e.split("=")})).find((function(t){var n=Object(l.a)(t,2),a=n[0];n[1];return a===e}))||[,null];return Object(l.a)(t,2)[1]}},{key:"delete",value:function(e){var t=new Date(0);document.cookie="".concat(e,"=;expires=").concat(t.toUTCString(),";path=/")}},{key:"clear",value:function(){document.cookie.split(";").map((function(e){return e.split("=")})).forEach((function(t){var n=Object(l.a)(t,1)[0];return e.delete(n)}))}}]),e}();O.msDay=864e5;var w={isOnline:!1,AuthToken:O.get("authToken"),isAuthenticated:!1,user:null,counter:0},x={setOnline:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.setState({isOnline:t})},addToCounter:function(e,t){e.setState({counter:e.state.counter+1})},setUserData:function(e,t){var n=t.AuthToken,a=t.Id,r=t.Name;e.setState({AuthToken:n,user:{Id:a,Name:r},isAuthenticated:!0}),O.set("authToken",n)},clearUserData:function(e){e.setState({AuthToken:null,user:null,isAuthenticated:!1}),O.delete("authToken")}},k=Object(E.a)(r.a,w,x);function y(e){var t=e.children,n=Object(v.a)(e,["children"]),a=k(),c=Object(l.a)(a,1)[0].isAuthenticated;return r.a.createElement(i.b,Object.assign({},n,{render:function(e){var n=e.location;return c?t:r.a.createElement(i.a,{to:{pathname:"/login",state:{from:n}}})}}))}var N=n(17),T=n(16),S=n(18),C=(n(40),function(e){function t(e){var n;return Object(g.a)(this,t),n=Object(N.a)(this,Object(T.a)(t).call(this,e)),b.then((function(e){console.log(e),n.setState({version:e})})).catch((function(e){console.log("err",e),n.setState({hasError:e})})).finally((function(){n.setState({isLoading:!1})})),n.state={isLoading:!0,hasError:null,version:null},n}return Object(S.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.state,t=e.version,n=e.hasError,a=e.isLoading;return r.a.createElement("div",{className:"version-holder"},a&&r.a.createElement("span",null,"loading..."),!a&&t&&r.a.createElement("span",null,"api ver: ",t),n?r.a.createElement("span",null,"Has error: ",JSON.stringify(n)):null)}}]),t}(r.a.Component)),A=n(12),D=(n(41),function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(N.a)(this,Object(T.a)(t).call(this,e))).state={isFocused:!1},n}return Object(S.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.label,a=t.value,c=t.helperText,o=t.icon,l=t.errorText,s=t.onChange,i=this.state.isFocused,u=0===a.length,f=!!l;return r.a.createElement("label",{className:m()("input cursor-pointer",{"is-focused":i,"is-empty":u,"has-error":f})},r.a.createElement("div",{className:"input-body flex-row justify-between"},r.a.createElement("div",{className:"flex-column justify-center position-relative w-100 px-2"},r.a.createElement("div",{className:"input-label"},n),r.a.createElement("input",{className:"input-value w-100",type:"text",value:a,onChange:function(e){return s(e.target.value)},onFocus:function(){return e.setState({isFocused:!0})},onBlur:function(){return e.setState({isFocused:!1})}})),o&&!f&&r.a.createElement("i",{className:"input-icon material-icons flex-row align-center mx-2"},o),f&&r.a.createElement("i",{className:"error-icon material-icons flex-row align-center mx-2"},"error")),r.a.createElement("hr",{className:"m-0"}),r.a.createElement("div",{className:"input-footer flex-row ml-2"},c&&!f&&r.a.createElement("span",{className:"helper-text text-ellipsis",title:c},c),f&&r.a.createElement("span",{className:"error-text text-ellipsis",title:l},l)))}}]),t}(r.a.Component));function U(){var e=k(),t=Object(l.a)(e,2);Object(A.a)(t[0]);var n=t[1].setUserData,c=Object(a.useState)("kekster2000"),o=Object(l.a)(c,2),u=o[0],m=o[1],f=Object(a.useState)("qwerty123"),p=Object(l.a)(f,2),h=p[0],b=p[1],v=Object(a.useState)(null),E=Object(l.a)(v,2),g=E[0],j=E[1],O=Object(i.g)(),w=(Object(i.h)().state||{from:{pathname:"/"}}).from;return r.a.createElement("div",{className:"form flex-column"},r.a.createElement(D,{label:"username",value:u,helperText:"username should be strong enough",errorText:g,icon:"face",onChange:function(e){return m(e)}}),r.a.createElement(D,{label:"password",value:h,helperText:"keep password simple",icon:"lock",onChange:function(e){return b(e)}}),r.a.createElement("button",{className:"button flex-row align-center justify-center",onClick:function(){(function(e){var t=e.username,n=e.password;return d("auth/login",{headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify({username:t,password:n})})})({username:u,password:h}).then((function(e){n(e),console.log("login ok",e),O.replace(w)})).catch((function(e){console.warn("login failed",e),j(e.message)}))}},r.a.createElement("span",null,"log in"),r.a.createElement("i",{className:"material-icons"},"arrow_forward")),r.a.createElement("span",{className:"p-2 flex-row justify-between"},"Don't have an account?",r.a.createElement(s.b,{to:"/register"},"register")))}function I(){var e=k(),t=Object(l.a)(e,2);Object(A.a)(t[0]);var n=t[1].setUserData,c=Object(a.useState)("jailbot007"),o=Object(l.a)(c,2),u=o[0],m=o[1],f=Object(a.useState)("kek123"),p=Object(l.a)(f,2),h=p[0],b=p[1],v=Object(a.useState)(null),E=Object(l.a)(v,2),g=E[0],j=E[1],O=Object(i.g)(),w=(Object(i.h)().state||{from:{pathname:"/"}}).from;return r.a.createElement("div",{className:"form flex-column"},r.a.createElement(D,{label:"username",value:u,helperText:"username should be strong enough",errorText:g,icon:"face",onChange:function(e){return m(e)}}),r.a.createElement(D,{label:"password",value:h,helperText:"keep password simple",icon:"lock",onChange:function(e){return b(e)}}),r.a.createElement("button",{className:"button flex-row align-center justify-center",onClick:function(){(function(e){var t=e.username,n=e.password;return d("auth/register",{headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify({username:t,password:n})})})({username:u,password:h}).then((function(e){n(e),console.log("register ok:",e),O.replace(w)})).catch((function(e){console.warn("register failed:",e.message),j(e.message)}))}},r.a.createElement("span",null,"register"),r.a.createElement("i",{className:"material-icons"},"add_box")),r.a.createElement("span",{className:"p-2 flex-row justify-between"},"Already have an account?",r.a.createElement(s.b,{to:"/login"},"log in")))}n(42);function J(){var e=k(),t=Object(l.a)(e,2),n=t[0],c=n.AuthToken,o=n.isAuthenticated,s=n.user,i=t[1],u=i.setUserData,m=i.clearUserData;return Object(a.useEffect)((function(){c&&function(e){return d("auth/status",{headers:{"Content-type":"application/json",authToken:e},method:"POST",body:JSON.stringify({gameRoomId:!0,lastActivityTime:!0,isOnline:!0,authToken:!0,id:!0,name:!0})}).then((function(e){return e.data}))}(c).then(u).catch(m)}),[]),r.a.createElement("div",{className:"status flex-column align-end p-1"},o?r.a.createElement("div",{className:"flex-row align-center"},r.a.createElement("span",null,s.Name),r.a.createElement("span",{style:{color:"black"}},s.Id),r.a.createElement("button",{className:"button flex-row align-center px-3",onClick:m},r.a.createElement("span",null," log out"),r.a.createElement("i",{className:"material-icons"},"exit_to_app"))):r.a.createElement("div",null,"unauthorized"))}n(43);function F(e){var t=e.children,n=Object(v.a)(e,["children"]),a=k(),c=Object(l.a)(a,1)[0].isAuthenticated;return r.a.createElement(i.b,Object.assign({},n,{render:function(){return c?r.a.createElement(i.a,{to:"/"}):t}}))}function _(){var e=k(),t=Object(l.a)(e,2),n=t[0].AuthToken;Object(A.a)(t[1]);var c=Object(a.useState)([]),o=Object(l.a)(c,2),s=o[0],u=o[1];Object(i.g)(),Object(i.h)();return Object(a.useEffect)((function(){var e;(e=n,d("room/list",{headers:{"Content-type":"application/json",authToken:e},method:"GET"})).then((function(e){u(e)}))}),[]),r.a.createElement("div",{className:"form flex-column"},r.a.createElement("ul",{className:"flex-column p-4"},s.map((function(e){return r.a.createElement("li",{className:"flex-row m-2",key:e.Id},r.a.createElement("span",null,e.Name),r.a.createElement("span",null,"status:",e.IsInGame),r.a.createElement("span",null,"plrs:",e.UserCount))}))),r.a.createElement("button",{className:"button flex-row align-center justify-center",onClick:function(){console.log("not impl")}},r.a.createElement("span",null,"create new room"),r.a.createElement("i",{className:"material-icons"},"add_box")))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement((function(){var e=k(),t=Object(l.a)(e,2),n=t[0],c=n.isOnline,o=n.isAuthenticated,u=t[1].setOnline;return Object(a.useEffect)((function(){b.then((function(e){return u(!0)}))}),[]),r.a.createElement(s.a,null,r.a.createElement("div",{className:m()("app",{"is-online":c})},r.a.createElement(C,null),r.a.createElement(J,null),r.a.createElement(i.d,null,r.a.createElement(F,{path:"/login"},r.a.createElement(U,null)),r.a.createElement(F,{path:"/register"},r.a.createElement(I,null)),r.a.createElement(y,{path:"/rooms"},r.a.createElement(_,null)),r.a.createElement(i.b,{path:"/"},r.a.createElement(i.a,{to:o?"/rooms":"/login"})))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[28,1,2]]]);
//# sourceMappingURL=main.fec9e8d4.chunk.js.map